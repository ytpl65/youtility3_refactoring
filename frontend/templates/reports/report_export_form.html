{% extends "base_form.html" %}

<!---- BEGIN PAGE TITLE ---->
{% block title %}
Report Form
{% endblock title %}
<!---- END PAGE TITLE ----->

{% block extra_css %}
{{ form.media.css }}
{% endblock extra_css %}


{% block form_title %}
Report Form
{% endblock form_title %}

<!-------------------------- BEGIN PAGE BREADCUMB ----------------------->
{% block pagebreadcumb %}
{{ super() }}
<li class="breadcrumb-item pe-3"><a href="javascript:void(0)" class="pe-3">Report Form</a></li>
{% endblock pagebreadcumb %}
<!-------------------------- END PAGE BREADCUMB ------------------------->


{% block nonfield_errors %}
{% if messages %}
{% for msg in messages %}
<div class="alert {{ msg.tags }} w-100 alert-dismissible fade show" role="alert">
 {{ msg }}
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
{% endfor %}
{% endif %}

{% endblock nonfield_errors %}

{% block form %}
<form action="{{ url('reports:exportreports') }}" method="post" id="report_form">
  <!-------------------------- CSRF MIDDLEWARE TOKEN --------------------->
  <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
  <input type="hidden" name="{{ form.ctzoffset.name }}" id = "{{ form.ctzoffset.auto_id }}" value="-1">
  <div class="row">
    <div class="col-sm-12 col-md-6">
      <div class="input-group mb-3">
        <div class="col-4">
          {{ form.report_name.label_tag() }}
        </div>
        <div class="col-8">
          {{ form.report_name }}
        </div>
      </div>
      <div class="input-group mb-3">
        <div class="col-4">
          {{ form.site.label_tag() }}
        </div>
        <div class="col-8">	
          {{ form.site }}
        </div>
      </div>
      <div class="input-group mb-3">
        <div class="col-4">
          {{ form.fromdate.label_tag() }}
        </div>
        <div class="col-8">
          {{ form.fromdate }}
        </div>
      </div>
      <div class="input-group mb-3">
        <div class="col-4">
          {{ form.uptodate.label_tag() }}
        </div>
        <div class="col-8">
          {{ form.uptodate }}
        </div>
      </div>
    </div>
	<div class="col-sm-12 col-md-6">
		<div class="input-group mb-3">
        <div class="col-4">
          {{ form.format.label_tag() }}
        </div>
        <div class="col-8">
          {{ form.format }}
        </div>
      </div>
	  <div class="input-group mb-3">
        <div class="col-4">
          {{ form.export_type.label_tag() }}
        </div>
        <div class="col-8">
          {{ form.export_type }}
        </div>
      </div>
	</div>
  </div>
  <div class="form-actions">
    <button type="submit" form="report_form" class="btn btn-sm btn-primary btn-hover-scale">

      Submit &nbsp;<i class="fas fa-cloud-upload-alt"></i>
    </button>

    <button type="button" id="btn_clear" class="btn btn-sm btn-secondary btn-hover-scale">
      Clear&nbsp;<i class="fas fa-times"></i>
    </button>
  </div>
</form>
{% endblock form %}

{% block extra_scripts %}
{{ form.media.js }}

<script>
  const urlname = "{{ url('reports:exportreports') }}"

  $(document).ready(() => {
    //set ctzoffset
    $("#id_ctzoffset").val(-new Date().getTimezoneOffset())
      
    $("#btn_clear").click(() => {
        location.href = `${urlname}?template=true`
    })

    $("#id_site").val(null).trigger('change') //clear default selection of site

    $("#id_fromdate, #id_uptodate").flatpickr({
            dateFormat: 'd-M-Y'
        })
	
	  $("[multiple]").select2({
          closeOnSelect:false 
      })
  })
</script>

{% endblock extra_scripts %}