{% extends "base_form.html" %}

<!---- BEGIN PAGE TITLE ---->
{% block title %}
Client Form
{% endblock title %}
<!---- END PAGE TITLE ----->

<!------- BEGIN HEAD ----->
{% block head %}
<link href="{{ static('assets/js/onboarding/hierarchy-select.min.css') }}" rel="stylesheet" type="text/css" />
{% endblock head %}
<!-------- END HEAD ------>

<!-------------------------- BEGIN PAGE BREADCUMB ----------------------->
{% block pagebreadcumb %}
{{ super() }}
<li class="breadcrumb-item pe-3"><a href="{{ url('onboarding:client_list') }}" class="pe-3">Client List</a></li>
<li class="breadcrumb-item pe-3"><a href="javascript:void(0)" class="pe-3">Client Form</a></li>
{% endblock pagebreadcumb %}
<!-------------------------- END PAGE BREADCUMB ------------------------->


<!-------------  BEGIN POP-UPS CODE -------------->
{% block popup_alerts %}
	{% if edit is defined %}
	<!-- to delete an instance with popup_alert pass the delete_url_name, instance_id, popup_title, popup_id -->
		{% call popup_alert('onboarding:client_delete', clientform.instance.btid, title="Delete", popup_id="delete_alert") %}
			<h4>Are you sure, you want to delete this?</h4>
		{% endcall %}
	{% endif %}
{% endblock popup_alerts %}
<!-------------  END POP-UPS CODE --------------> 


<!------ BEGIN FORM TITLE ------->
{% block form_title %}
Client
{% endblock form_title %}
<!------ END FORM TITLE -------->


<!--------- BEGIN NON FIELD ERRORS -------->
{% block nonfield_errors %}
	{% if clientform.non_field_errors() %}
	<div id="non_field_error" class="alert alert-danger" style="width: 73%;">
		{% for error in clientform.non_field_errors() %}
		{{ error }}
		{% endfor %}
        <button type="button" class="btn-close flt-right" data-bs-dismiss="alert" aria-label="Close"></button>
	</div>
	{% endif %}
    {% if clientprefsform.non_field_errors() %}
	<div id="non_field_error" class="alert alert-danger" style="width: 73%;">
		{% for error in clientprefsform.non_field_errors() %}
		{{ error }}
		{% endfor %}
        <button type="button" class="btn-close flt-right" data-bs-dismiss="alert" aria-label="Close"></button>
	</div>
	{% endif %}
{% endblock nonfield_errors %}
<!---------- END NON FIELD ERRORS --------->


<!----------- BEGIN FORM MESSGES --------------->
{% block form_msgs %}
	{% for msg in get_msgs(request) %}
	<div class="alert {% if msg.tags %} {{ msg.tags }} {% endif %} " id="alert_msg" style="width:73%; ">
		{{ msg }}
		<button type="button" class="btn-close flt-right" data-bs-dismiss="alert" aria-label="Close"></button>
	</div>
	{% endfor %}
{% endblock form_msgs %}
<!----------- END FORM MESSGES ----------------->


<!-------------- BEGIN FORM ------------------->
{% block form %}
    <form action="" method='post' id="id_clientform">
        <!-------------------------- CSRF MIDDLEWARE TOKEN --------------------->
        <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
        <div class="mb-3 row g-3 gx-6">
            {{ clientform.butype.label_tag() }}
            <div class="col-md-4 col-sm-4">
                {{ clientform.butype }}
                <!--HELP TEXT-->
                {% if clientform.butype.help_text %}
                <small>{{ clientform.butype.help_text }}</small>
                {% endif %}
                <!----- BEGIN ERROR FIELD  ------->
                {{ clientform.butype.errors }}
                <!----- END ERROR FIELD  ------->
            </div>
            {{ clientform.bucode.label_tag() }}
            <div class="col-md-4 col-sm-4">
                {{ clientform.bucode }}
                <!--HELP TEXT-->
                {% if clientform.bucode.help_text %}
                <small>{{ clientform.bucode.help_text }}</small>
                {% endif %}
                <!----- BEGIN ERROR FIELD  ------->
                {{ clientform.bucode.errors }}
                <!----- END ERROR FIELD  ------->
            </div>
            {{ clientform.buname.label_tag() }}
            <div class="col-md-4 col-sm-4">
                {{ clientform.buname }}
                <!--HELP TEXT-->
                {% if clientform.buname.help_text %}
                <small>{{ clientform.buname.help_text }}</small>
                {% endif %}
                <!----- BEGIN ERROR FIELD  ------->
                {{ clientform.buname.errors }}
                <!----- END ERROR FIELD  ------->
            </div>
            {% for field in clientprefsform %}
                {% if field.name in ['validimei', 'validip', 'reliveronpeoplecount',
                                    'pvideolength'] %}
                    <!------LABEL FIELD --->
                    {{ field.label_tag() }}
                    <div class="col-md-4 col-sm-4">
                    {{ field }}
                    <!---- HELP TEXT ---->
                    {% if field.help_text %}
					<small>{{ field.help_text }}</small>
					{% endif %}

                    <!----- BEGIN ERROR FIELD  ----->
					{{ field.errors }}
					<!----- END ERROR FIELD  ------->
                    </div>
                    
                {% else %}
                {% endif %}
            {% endfor %}
            <!------------ BEIGN CHECKBOX RENDERING LAST --------------------->
            <div class="booleans col-md-12 d-flex justify-content-sm-between mt-5">
                {% for checkbox_field in clientform %}
                {% if (checkbox_field.widget_type=='checkbox' and checkbox_field.name in [
                    'gpsenable', 'skipsiteaudit', 'deviceevent', 'enablesleepingguard', 'enable'
                ]) %}
                <label for={{ checkbox_field.id_for_label }}
                    class="form-check-label bool col-form-label me-5 text-sm-right">{{ checkbox_field }}
                    &nbsp{{ checkbox_field.label }}</label>
                {% endif %}
                {% endfor %}
                <label for={{ clientprefsform.usereliver.id_for_label }}
                    class="form-check-label bool col-form-label me-5 text-sm-right">{{ clientprefsform.usereliver }}
                    &nbsp{{ clientprefsform.usereliver.label }}</label>
            </div>
            <!------------ END CHECKBOX RENDERING LAST ------------------------>
        </div>
        <hr>
    </form>
{% endblock form %}

{% block extras %}
    <div class="my-3 row g-3 gx-6" >
        <div class="col-md-3 col-sm-3">
            <h4>Web Capability</h4>
            <!---- WEB CAPABILITY FIELD --->
            {{ clientprefsform.webcapability }}
        </div>
        <div class="col-md-3 col-sm-3">
            <h4>Mobile Capability</h4>
            <!---- MOBILE CAPABILITY FIELD --->
            {{ clientprefsform.mobilecapability }}
        </div>
        <div class="col-md-3 col-sm-3">
            <h4>Report Capability</h4>
            <!---- REPORT CAPABILITY FIELD --->
            {{ clientprefsform.reportcapability }}
        </div>
        <div class="col-md-3 col-sm-3">
            <h4>Poertlet Capability</h4>
            <!---- PORTLET CAPABILITY FIELD --->
            {{ clientprefsform.portletcapability }}
        </div>
        
    </div>
{% endblock extras %}
<!------------- END FORM ---------------------->


<!------------------- BEGIN FORM PAGE ACTIONS --------------->
{% block page_actions %}
{% if edit is defined %}
    {{ form_update('id_clientform', popup_id="delete_alert") }}
{% else %}
    {{ form_create('id_clientform') }}
{% endif %}
{% endblock page_actions %}
<!------------------- END FORM PAGE ACTIONS --------------->


{% block extra_scripts %}
<script src="{{ static('assets/js/onboarding/client_buform.js') }}" type="text/javascript"></script>
<script>
{# 
build_caps_heirarchy({{ webcaps }}); #}
</script>

{% endblock extra_scripts %}